<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/main}" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="ISO-8859-1">
<link rel="stylesheet" type="text/css"
	href="/assets/css/jquery.multiselect.css">
<script type="text/javascript" src="/assets/js/jquery.multiselect.js"></script>

<title>Appointment</title>
</head>
<body>
	<div layout:fragment="content">
		<div class="container pt-4 pb-4">
			<div class="row">
				<div class="col-sm-4 col-3">
					<h4 class="page-title">Appointment: AP-0001</h4>
				</div>

			</div>
			<!-- 			patient information -->
			<div class="row">
				<div class="col-md-12">
					<div class="card-box profile-header">
						<div class="row">
							<div class="col-md-12">
								<div class="profile-view">
									<div class="profile-img-wrap">
										<div class="profile-img">
											<a href="#"><img class="avatar"
												src="assets/img/doctor-03.jpg" alt=""></a>
										</div>
									</div>
									<div class="profile-basic">
										<div class="row">
											<div class="col-md-5">
												<div class="profile-info-left">
													<h3 class="user-name m-t-0 mb-0">Authur Flex</h3>
													<div class="staff-id">Age: 47</div>
													<div class="staff-id">Patient ID : PA-0001</div>
												</div>
											</div>
											<div class="col-md-7">
												<ul class="personal-info">
													<li><span class="title">Phone:</span> <span
														class="text"><a href="#">770-889-6484</a></span></li>
													<li><span class="title">Email:</span> <span
														class="text"><a href="#">cristinagroves@example.com</a></span>
													</li>
													<li><span class="title">Address:</span> <span
														class="text">714 Burwell Heights Road, Bridge City,
															TX, 77611</span></li>
													<li><span class="title">Gender:</span> <span
														class="text">Female</span></li>
												</ul>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- 			main profile information -->
			<div class="row">
				<div class="col-md-12">
					<div class="card-box">
						<h4 class="payslip-title">Medical Care Information</h4>
						<div class="row">
							<div class="col-lg-6 m-b-20">

								<ul class="list-unstyled">
									<li>
										<h4 class="mb-0">
											<strong>Symptom(s)</strong><span class="text"><small><a
													href="#" data-toggle="modal"
													data-target="#exampleModalSymptom"> Edit</a></small></span>
										</h4> <!-- Modal -->
										<div class="modal fade" id="exampleModalSymptom" tabindex="-1"
											role="dialog" aria-labelledby="exampleModalLabel"
											aria-hidden="true">
											<div class="modal-dialog" role="document">
												<div class="modal-content">
													<div class="modal-header">
														<h5 class="modal-title" id="exampleModalLabel">Symptom
															edit</h5>
														<button type="button" class="close" data-dismiss="modal"
															aria-label="Close">
															<span aria-hidden="true">&times;</span>
														</button>
													</div>
													<div class="modal-body">
														<select multiple="multiple" id="select-symptom"
															name="my-select[]">
															<option value='elem_1'>Back hurt</option>
															<option value='elem_2'>Chest hurt</option>
															<option value='elem_3'>Chills</option>
															<option value='elem_4'>Fever</option>
															<option value='elem_100'>Tired</option>
														</select>
													</div>
													<div class="modal-footer">
														<button type="button" class="btn btn-secondary"
															data-dismiss="modal">Close</button>
														<button type="button" class="btn btn-primary">Save
															changes</button>
													</div>
												</div>
											</div>
										</div>
									</li>
									<li></li>
								</ul>

								<ul class="list-unstyled">
									<li>
										<h4 class="mb-0">
											<strong>Examination(s)</strong><span class="text"><small><a
													href="#" data-toggle="modal"
													data-target="#exampleModalExamination"> Edit</a></small></span>
										</h4> <!-- Modal -->
										<div class="modal fade" id="exampleModalExamination"
											tabindex="-1" role="dialog"
											aria-labelledby="exampleModalLabel" aria-hidden="true">
											<div class="modal-dialog" role="document">
												<div class="modal-content">
													<div class="modal-header">
														<h5 class="modal-title" id="exampleModalExaminationLabel">Symptom
															edit</h5>
														<button type="button" class="close" data-dismiss="modal"
															aria-label="Close">
															<span aria-hidden="true">&times;</span>
														</button>
													</div>
													<div class="modal-body">
														<select multiple="multiple" id="select-examination"
															name="my-select[]">
															<option value='elem_1'>Blood test</option>
															<option value='elem_2'>X-Ray</option>
														</select>
													</div>
													<div class="modal-footer">
														<button type="button" class="btn btn-secondary"
															data-dismiss="modal">Close</button>
														<button type="button" class="btn btn-primary">Save
															changes</button>
													</div>
												</div>
											</div>
										</div>
									</li>
									<li></li>
								</ul>

							</div>
							<div class="col-sm-6">
								<div>
									<h4 class="mb-0">
										<strong>Diagnosis Conclusion</strong><span class="text"><small><a
												href="#" onclick="NewDiagnosis()"> Create</a></small></span>
									</h4>
									<table class="table table-bordered">
										<tbody id="DiagnosisList">

										</tbody>
									</table>
								</div>

								<div>
									<h4 class="mb-0">
										<strong>Treatment Conclusion</strong><span class="text"><small><a
												href="#" onclick="NewTreatment()"> Create</a></small></span>
									</h4>
									<table class="table table-bordered">
										<tbody id="TreatmentList">

										</tbody>
									</table>
								</div>

								<div>
									<h4 class="mb-0">
										<strong>Prescription</strong><span class="text"><small><a
												href="#" onclick="NewPrescription()"> Create</a></small></span>
									</h4>
									<table class="table table-bordered">
										<tbody>
											<tr>
												<td><strong>Phenorbabital, 30mg</strong> <span
													class="float-right">24 tablet</span></td>
											</tr>
											<tr>
												<td><strong>Aspirin 3.6g</strong> <span
													class="float-right">12 capsules</span></td>
											</tr>
											<tr>
												<td><strong>Avoid alcohol</strong> <span
													class="float-right"></span></td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- 		Diagnosis Detail modal -->
		<div id="MyModal" class="modal fade">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header" align="center">
						<h4 class="col-sm-12 modal-title text-center" align="center">
							<h id="ModalTitle"></h>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</h4>
					</div>

					<div class="modal-body">
						<h3>Illness Detail</h3>
						<div>
							<div class="table-responsive">
								<table class="table table-bordered">
									<tr>
										<th>Illness ID</th>
										<td id="IllnessID"></td>
									</tr>
									<tr>
										<th>Name</th>
										<td id="Name"></td>
									</tr>
									<tr>
										<th>Description</th>
										<td id="Description"></td>
									</tr>
									<tr>
										<th>Season</th>
										<td id="Season"></td>
									</tr>
									<tr>
										<th>Illness Type</th>
										<td id="IllnessType"></td>
									</tr>
									<tr>
										<th>Created Date</th>
										<td id="CreatedDate"></td>
									</tr>
									<tr>
										<th>Created By</th>
										<td id="CreatedBy"></td>
									</tr>
									<tr>
										<th>Modified Date</th>
										<td id="ModifiedDate"></td>
									</tr>
									<tr>
										<th>Modified By</th>
										<td id="ModifiedBy"></td>
									</tr>
								</table>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>

		<!-- 		Treatment Detail modal -->
		<div id="TreatmentDetailModal" class="modal fade">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header" align="center">
						<h4 class="col-sm-12 modal-title text-center" align="center">
							<h id="TreatmentDetailModalTitle"></h>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</h4>
					</div>

					<div class="modal-body">
						<h3>Treatment Detail</h3>
						<div>
							<div class="table-responsive">
								<table class="table table-bordered">
									<tr>
										<th>Treatment ID</th>
										<td id="TreatmentID"></td>
									</tr>
									<tr>
										<th>Treatment Method</th>
										<td id="Method"></td>
									</tr>
									<tr>
										<th>Illness</th>
										<td id="IllnessTreatment"></td>
									</tr>
									<tr>
										<th>Date</th>
										<td id="Date"></td>
									</tr>
									<tr>
										<th>Created Date</th>
										<td id="CreatedDate"></td>
									</tr>
									<tr>
										<th>Created By</th>
										<td id="CreatedBy"></td>
									</tr>
									<tr>
										<th>Modified Date</th>
										<td id="ModifiedDate"></td>
									</tr>
									<tr>
										<th>Modified By</th>
										<td id="ModifiedBy"></td>
									</tr>
								</table>
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
		<!-- 		Diagnosis modal -->
		<div id="DiagModal" class="modal fade">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header" align="center">
						<h4 class="col-sm-12 modal-title text-center" align="center">
							<h id="DiagModalTitle"></h>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</h4>
					</div>

					<div class="modal-body">
						<h3>Diagnosis</h3>
						<form th:object="${diag}" th:action="@{/admin/diagnosis/save}"
							method="post">
							<input type="hidden" th:field="*{diagnosisId}" id="DiagnosisID" />

							<input type="hidden" th:field="*{appointment.appId}" id="AppID" />

							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<label>Illnesses For Diagnosis</label> <input type="checkbox"
											value="Bike" id="checkSuggest" onclick="suggestCheckDiag(this)">Illness
										Suggestion <select th:field="*{illness.illnessId}"
											class="form-control" id="illsug" disabled>
											<option th:each="i:${illsug}" th:value="${i.illnessId}"
												th:utext=${i.name} />
										</select>
										<!-- 										<select th:field="*{illness.illnessId}" class="form-control" multiple="multiple" id="multi-illness"> -->
										<!-- 											<option th:each="i : ${illsug}" -->

										<!-- 												th:value="${i.illnessId}" th:utext="${i.name}">Illness -->
										<!-- 												name -->
										<!-- 											</option> -->
										<!-- 										</select> -->

									</div>
								</div>
								<div class="col-sm-6">
									<div class="form-group">
										<label>Degree</label> <input class="form-control" type="text"
											th:field="*{degree}" id="degree">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<select th:field="*{illness.illnessId}" class="form-control"
											id="illall">
											<option th:each="i:${illall}" th:value="${i.illnessId}"
												th:utext=${i.name} />
										</select>
									</div>
								</div>
							</div>

							<div class="m-t-20 text-center">
								<button class="btn btn-primary submit-btn"
									id="submit-new-period" onclick="SaveDiagnosis()">SAVE</button>
							</div>
						</form>


					</div>
				</div>
			</div>
		</div>

		<!-- 		Treatment modal -->
		<div id="TreatModal" class="modal fade">
			<div class="modal-dialog modal-lg">
				<div class="modal-content">
					<div class="modal-header" align="center">
						<h4 class="col-sm-12 modal-title text-center" align="center">
							<h id="TreatModalTitle"></h>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</h4>
					</div>

					<div class="modal-body">
						<h3>Treatment</h3>
						<form th:object="${treatment}"
							th:action="@{/admin/treatment/save}" method="post">
							<input type="hidden" th:field="*{treatmentId}" id="TreatmentId" />

							<input type="hidden" th:field="*{appointment.appId}" id="TreatAppID" />

							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<label>Treatments for patient</label> <input type="checkbox"
											value="Bike" id="checkSuggest" onclick="suggestCheckTreat(this)">Treatment
										Suggestion <select
											th:field="*{treatmentMethod.treatmentMethodId}"
											class="form-control" id="treatsug" disabled>
											<option th:each="t:${treatsug}"
												th:value="${t.treatmentMethodId}" th:utext=${t.name} />
										</select>
									</div>
								</div>
								<div class="col-sm-6">
									<div class="form-group">
										<label>Illness</label> <input class="form-control" type="text"
											th:field="*{illness.illnessId}" id="TreatIllID">
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<select th:field="*{treatmentMethod.treatmentMethodId}"
											class="form-control" id="treatall">
											<option th:each="t:${treatall}"
												th:value="${t.treatmentMethod.treatmentMethodId}" th:utext=${t.treatmentMethod.name} />
										</select>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									<div class="form-group">
										<label>Treatment Time</label> <input class="form-control" type="date"
											th:field="*{treatmentTime}" id="TreatmentTime">
									</div>
								</div>
								<div class="col-sm-6">
									<div class="form-group">
										<label>Follow up date</label> <input class="form-control" type="date"
											th:field="*{followupDate}" id="FollowupDate">
									</div>
								</div>
							</div>

							<div class="m-t-20 text-center">
								<button class="btn btn-primary submit-btn"
									id="submit-new-period" onclick="SaveTreatment()">SAVE</button>
							</div>
						</form>


					</div>
				</div>
			</div>
		</div>



		<script th:inline="javascript">
		$(document).ready(function() {
			loadDiagnosis();
			loadTreatment();
		});
		

		function loadDiagnosis(){
			var appID = [[${appID}]] ;
			var url = "/admin/diagnosis/getDiagnosisByAppID/"+ appID;
		    $.ajax({
		    	type: "GET",
		    	url: url,
		    	success: function (data) {
		        	var SetData = $("#DiagnosisList");
		        	for (var i = 0; i < data.length; i++) {
		                		
		        	var list =                             
					"<tr>"+
					"<td><strong>"+ data[i].illness.name +"</strong>"+ 
					"<span class='float-right'>"+data[i].degree+"</span></td>"+
					"<td>" + "<a href='#' onclick='ViewIllnessDetail(" + data[i].illness.illnessId + ")' >Detail</a>"+
					"<a href='#' onclick='EditDiagnosis("+data[i].diagnosisId+")'><i class='fa fa-pencil m-r-5'></i>Edit        </a>"+
					"<a href='#' onclick='DeleteDiagnosis("+data[i].diagnosisId+")'><i class='fa fa-trash-o m-r-5'></i>Delete</a>"+
					"</tr>";		                	
		         	SetData.append(list);
		            }
		        }
            });			
		}
		
		function loadTreatment(){
			var appID = [[${appID}]] ;
			var url = "/admin/treatment/getAllTreatmentByAppID/"+ appID;
		    $.ajax({
		    	type: "GET",
		    	url: url,
		    	success: function (data) {
		        	var SetData = $("#TreatmentList");
		        	for (var i = 0; i < data.length; i++) {
		                		
		        	var list =                             
					"<tr>"+
					"<td><strong>"+ data[i].treatmentMethod.name +"</strong>"+ 
					"<span class='float-right'>"+data[i].illness.name+"</span></td>"+
					"<td>" + "<a href='#' onclick='ViewTreatmentDetail(" + data[i].treatmentId + ")' >Detail</a>"+
					"<a href='#' onclick='EditTreatment("+data[i].treatmentId+")'><i class='fa fa-pencil m-r-5'></i>Edit        </a>"+
					"<a href='#' onclick='DeleteTreatment("+data[i].treatmentId+")'><i class='fa fa-trash-o m-r-5'></i>Delete</a>"+
					"</tr>";		                	
		         	SetData.append(list);
		            }
		        }
            });			
		}
		
		function ViewIllnessDetail(illnessID){
	        var url = "/admin/illness/illness/getIllnessByID/" + illnessID;
	        $("#ModalTitle").html("Illness Detail");
	        $("#MyModal").modal();
	        $.ajax({
	            type: "GET",
	            url: url,
	            success: function (data) {
	                $("#IllnessID").html(data.illnessId);
	                $("#Name").html("Patient ID: "+data.name);
	                $("#Description").html(data.description);
	                $("#Season").html(data.season);
	                $("#IllnessType").html(data.illnessType.name);
	                $("#CreatedDate").html(data.createdDate);
	                $("#CreatedBy").html(data.createdBy);
	                $("#ModifiedDate").html(data.modifiedDate);
	                $("#ModifiedBy").html(data.modifiedBy);
	                
	            }
	        })
		}
		
		function ViewTreatmentDetail(id){
	        var url = "/admin/treatment/getTreatmentByID/" + id;
	        $("#TreatmentDetailModalTitle").html("Illness Detail");
	        $("#TreatmentDetailModal").modal();
	        $.ajax({
	            type: "GET",
	            url: url,
	            success: function (data) {
	                $("#TreatmentID").html(data.treatmentId);
	                $("#Method").html(data.treatmentMethod.name);
	                $("#IllnessTreatment").html(data.illness.name);
	                $("#Date").html(data.treatmentTime);
	                $("#CreatedDate").html(data.createdDate);
	                $("#CreatedBy").html(data.createdBy);
	                $("#ModifiedDate").html(data.modifiedDate);
	                $("#ModifiedBy").html(data.modifiedBy);	                
	            }
	        })
		}
		
		function NewDiagnosis(){
			var appID = [[${appID}]] ;
			
	        $("#DiagModalTitle").html("Illness Diagnosis");
	        $("#DiagModal").modal();
	        $("#AppID").val(appID);
// 		    $('select[multiple]').multiselect({
// 			    columns: 1,
// 			    search: true,
// 			    minHeight:100
// 			});
		}
		
		
		function NewTreatment(){
			var appID = [[${appID}]] ;
			
	        $("#TreatModalTitle").html("Treatments For Patient");
	        $("#TreatModal").modal();
	        $("#TreatAppID").val(appID);
		}
		
		
	    function EditDiagnosis(diagnosisID) {
	        var url = "/admin/diagnosis/getDiagnosisByID/" + diagnosisID;
	        $("#DiagModalTitle").html("Edit Diagnosis");
	        $("#DiagModal").modal();
	        $.ajax({
	            type: "GET",
	            url: url,
	            success: function (data) {
	                $("#DiagnosisID").val(data.diagnosisId);
	                $("#AppID").val(data.appointment.appId);
	                $("#illsug").val(data.illness.illnessId);
	                $("#illall").val(data.illness.illnessId);
	                $("#degree").val(data.degree);
	            }
	        })
	    }
	    
	    function EditTreatment(treatmentID) {
	        var url = "/admin/treatment/getTreatmentByID/" + treatmentID;
	        $("#TreatModalTitle").html("Edit Treatment");
	        $("#TreatModal").modal();
	        $.ajax({
	            type: "GET",
	            url: url,
	            success: function (data) {
	                $("#TreatmentId").val(data.treatmentId);
	                $("#TreatAppID").val(data.appointment.appId);
	                $("#treatsug").val(data.treatmentMethod.treatmentMethodId);
	                $("#treatall").val(data.treatmentMethod.treatmentMethodId);
	                $("#TreatIllID").val(data.illness.illnessId);
	                $("#TreatmentTime").val(data.treatmentTime);
	                $("#FollowupDate").val(data.followupDate);
	            }
	        })
	    }
		
	    function suggestCheckDiag(checkbox){
	    		document.getElementById('illall').disabled = checkbox.checked;
	    		document.getElementById('illsug').disabled = !checkbox.checked;
	    }
	    
	    function suggestCheckTreat(checkbox){
    		document.getElementById('treatall').disabled = checkbox.checked;
    		document.getElementById('treatsug').disabled = !checkbox.checked;
	    }
		

		</script>
	</div>
</body>
</html>